# excel-nums

Сервис, который читает целые числа из локального Excel-файла (`.xlsx`) и
возвращает N-ое минимальное число без использования встроенной сортировки.  
Для поиска используется алгоритм Quickselect - данные обрабатываются с учётом дубликатов, например, [1, 1, 2, 3], при
n = 2 метод вернёт 1.

## Требования

- Java 21+
- Maven 3.9+
- Установленный Git (опционально, если будете клонировать репозиторий)
- Локальный `.xlsx`-файл, доступный по пути, который будет передан в запросе

## Технологии

- Java 21
- Spring Boot 3
- Spring Web (REST API)
- Springdoc OpenAPI (Swagger UI)
- Apache POI (чтение Excel-файлов)
- Lombok (для сокращения шаблонного кода)
- Maven

## Сборка

Клонируйте репозиторий любым удобным способом и в корне проекта выполните:

```bash
  mvn clean package
```

Будет собран исполняемый JAR: `target/excel-nums-0.0.1-SNAPSHOT.jar`

## Запуск

```bash
  java -jar target/excel-nums-0.0.1-SNAPSHOT.jar
```

## Настройки Excel-ридера

Параметры можно задавать в `aplication.properties`:

- `excel.reader.initial-buffer-capacity` — начальный размер массива при чтении файла, увеличивается по мере роста
  данных.
- `excel.reader.allowed-extensions` — список разрешённых расширений через запятую. Можно указывать **с точкой или без
  ** — оба варианта корректно обрабатываются, например: `xlsx` или `.xlsx`.

## Пример использования с curl

```bash
  curl -X POST http://localhost:8080/api/excel/nth-min \
  -H "Content-Type: application/json" \
  -d '{"filePath": "path/to/your/file/numbers.xlsx", "n": 1}'
```

## Тесты

Проект содержит тесты для проверки чтения Excel-файлов и работы алгоритма Quickselect.  
Они выполняются автоматически при сборке, можно также отдельной командой:

```bash
  mvn test
```

## Swagger / OpenAPI

<http://localhost:8080/swagger-ui.html>

## Идеи по улучшению

1. Вынести в настройки, что делать в случае если в столбе не число, сейчас бросает ошибку, можно пропускать.
2. Вынести в настройки обрабатывать ли формулы, сейчас обрабатываются.
3. Добавить в настройки как поступать с дубликатами.
4. Добавить в настройки возможность выбора листа Excel-документа.
5. Сделать отдельный класс для динамического массива `IntDinamicArray` для повторного использования.
6. Добавить поддержку чтения файлов по URL (HTTP/HTTPS).
7. Добавить ExceptionHandler.
8. Полное покрытие тестам, сейчас минимум для себя.
9. `Dockerfile` с инструкцией запуска с монтированием тома.
10. Можно ещё пофантазировать на тему, а что если читать не столбцы, а строки, или может быть не только Excel-файлы.